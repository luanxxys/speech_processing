# 基音周期估计 - Pitch Detection

### 基音与基音周期估计

人在发音时，根据声带是否震动可以将语音信号分为**清音**跟**浊音**两种。

浊音又称有声语言，携带者语言中大部分的能量，**浊音在时域上呈现出明显的周期性**。

**清音类似于白噪声**，没有明显的周期性。

发浊音时，气流通过声门使声带产生张弛震荡式振动，产生准周期的激励脉冲串。这种声带振动的频率称为**基音频率**，相应的周期就成为**基音周期**。

一般来说，男性说话者的基音频率较低，而女性说话者和小孩的基音频率相对较高。

基音周期的估计称为**基音检测**，基音检测的最终**目的是为了找出和声带振动频率完全一致或尽可能相吻合的轨迹曲线。**

基因周期作为语音信号处理中描述激励源的重要参数之一，在语音合成、语音压缩编码、语音识别和说话人确认等领域都有着广泛而重要的问题，尤其对汉语更是如此。

汉语是一种有调语言，而**基因周期的变化称为声调**，声调对于汉语语音的理解极为重要。因为在汉语的相互交谈中，不但要凭借不同的元音、辅音来辨别这些字词的意义，还需要从不同的声调来区别它，也就是说声调具有辨义作用；另外，汉语中存在着多音字现象，同一个字的不同的语气或不同的词义下具有不同的声调。因此准确可靠地进行基音检测对汉语语音信号的处理显得尤为重要。

### 基音周期估计的现有方法

1. **时域估计法**，直接由语音波形来估计基音周期。

        自相关法、并行处理法、平均幅度差法、数据减少法等

1. **变换法**，它是一种将语音信号变换到频域或者时域来估计基音周期的方法，首先利用同态分析方法将声道的影响消除，得到属于激励部分的信息，然后求取基音周期。

        最常用的就是倒谱法，这种方法的缺点就是算法比较复杂，但是基音估计的效果却很好

1. **混合法**，先提取信号声道模型参数，然后利用它对信号进行滤波，得到音源序列，最后再利用自相关法或者平均幅度差法求得基因音周期。

### 基于自相关的基音周期检测

- ##### 自相关函数

    能量有限的语音信号x(n)的短时自相关函数定义为

    <a href="https://www.codecogs.com/eqnedit.php?latex=R(m)=\sum_{n=-\infty&space;}^{n=&plus;\infty}&space;x(n)&space;x(n&plus;m)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?R(m)=\sum_{n=-\infty&space;}^{n=&plus;\infty}&space;x(n)&space;x(n&plus;m)" title="R(m)=\sum_{n=-\infty }^{n=+\infty} x(n) x(n+m)" /></a>

    此公式表示一个信号和延迟m点后该信号本身的相似性。如果信号x(n)具有周期性，那么它的自相关函数也具有周期性，而且周期与信号x(n)的周期性相同。

    自相关函数提供了一种获取周期信号周期的方法。在周期信号周期的整数倍上，它的自相关函数可以达到最大值，因此可以不考虑起始时间，而从自相关函数的第一个最大值的位置估计出信号的基音周期，这使自相关函数成为信号基音周期估计的一种工具。

- ##### 短时自相关函数法

    语音信号是非稳态信号它的特征是随时间变化的，但在一个很短的时间段内可以认为具有相对稳定的特征即短时平稳性。因此语音具有短时自相关性。这个时间段约5ms-50ms。为其统计特性和频谱特性都是对短时段而言的。这使得要对语音信号作数字处理必须先按短时段对语音信号分帧。这样每一帧信号都具有短时平稳性从而进行短时相关分析。

    能量有限的语音信号s(n)的短时自相关函数定义为

    <img src="https://latex.codecogs.com/gif.latex?R_{n}(\tau&space;)=\sum_{m=0&space;}^{n-1-\tau}&space;\left&space;[&space;s(n&plus;m)w(m)&space;\right&space;]&space;\left[&space;s(n&plus;m&plus;\tau)w(m&plus;\tau)&space;\right&space;]" title="R_{n}(\tau )=\sum_{m=0 }^{n-1-\tau} \left [ s(n+m)w(m) \right ] \left[ s(n+m+\tau)w(m+\tau) \right ]" />

    一般要求一帧至少包含 2 个以上的周期。一般，基频最低 50Hz，故周期最长为 20ms。而且相邻帧之间要有足够的重叠。具体应用时，窗口长度根据采样率确定帧长。

### 基于自相关的基音周期检测算法实现

1. 先要确定帧长 <-- 考虑所包含的周期数

1. 通过计算短时能量区分 voice 和 unvoice

    语音信号{x(n)}的某帧信号的短时平均能量En的定义为

    <img src="https://latex.codecogs.com/gif.latex?E_{n}=\sum_{m=n-N&plus;1&space;}^{n}&space;\left&space;[&space;x(m)w(n-m)&space;\right&space;]^{2}" title="E_{n}=\sum_{m=n-N+1 }^{n} \left [ x(m)w(n-m) \right ]^{2}" />

    语音中浊音段的短时平均能量远远大于清音段的短时平均能量。因此，短时平均能量的计算给出了区分清音段与浊音段的依据，即En(浊)>En(清)。

1. 图中计算该语音的所有帧对应的基音周期的点，由图可以看出存在不少的野点。因为，需要对此进行进一步的处理，即去除野点。这里通过中值滤波来除去野点。

- [source from zouxy09](http://blog.csdn.net/zouxy09/article/details/9141875)
